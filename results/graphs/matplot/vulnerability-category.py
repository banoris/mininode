import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

filename = '../data/fixed-unique-advisories.csv'
# filename = '../data/reduced-advisories.csv'
data = pd.read_csv(filename)
data = data.sort_values(by=['total', 'high', 'medium', 'low'], ascending=False)
data = data.head(10)
bar_width = 0.2
index = np.arange(data['name'].size) # x - index

plt.bar(index, data['total'], bar_width, label='Total')
plt.bar(index + bar_width, data['high'], bar_width, label='High severity')
plt.bar(index + 2*bar_width, data['medium'], bar_width, label='Medium severity')
plt.bar(index + 3*bar_width, data['low'], bar_width, label='Low severity')

plt.ylabel('Number of packages')
plt.yscale('log')
plt.xlabel('')
plt.title('Most Common Vulnerability Categories and Their Distribution')
plt.xticks(index+bar_width, data['name'], rotation=-30, ha='left')
plt.legend()
plt.tight_layout()
plt.show()
